<div class="auth-container">
  <div class="auth-card-wrapper">
    <mat-card class="auth-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon class="auth-icon">lock_reset</mat-icon>
          Reset Password
        </mat-card-title>
        <mat-card-subtitle>
          Enter your email to receive password reset instructions
        </mat-card-subtitle>
      </mat-card-header>

      <mat-card-content>
        @if (!emailSent()) {
          <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="auth-form">
            <!-- Email Field -->
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Email</mat-label>
              <input
                matInput
                type="email"
                formControlName="email"
                placeholder="your@email.com"
                [class.is-invalid]="isFieldInvalid('email')"
              >
              <mat-icon matSuffix>email</mat-icon>
              @if (isFieldInvalid('email')) {
                <mat-error>
                  @if (forgotPasswordForm.get('email')?.errors?.['required']) {
                    Email is required
                  }
                  @if (forgotPasswordForm.get('email')?.errors?.['email']) {
                    Please enter a valid email
                  }
                </mat-error>
              }
            </mat-form-field>

            <!-- Submit Button -->
            <button
              mat-raised-button
              color="primary"
              type="submit"
              class="full-width auth-submit-btn"
              [disabled]="forgotPasswordForm.invalid || isLoading()"
            >
              @if (isLoading()) {
                <mat-spinner diameter="20" color="accent"></mat-spinner>
                Sending...
              } @else {
                <mat-icon>send</mat-icon>
                Send Reset Link
              }
            </button>
          </form>
        } @else {
          <!-- Success Message -->
          <div class="success-message">
            <mat-icon class="success-icon">check_circle</mat-icon>
            <h3>Email Sent!</h3>
            <p>
              We've sent password reset instructions to your email address.
              Please check your inbox and follow the link to reset your password.
            </p>
            <p class="note">
              Didn't receive the email? Check your spam folder or
              <button type="button" class="resend-link" (click)="resendEmail()">
                try again
              </button>
            </p>
          </div>
        }
      </mat-card-content>

      <mat-card-actions class="auth-actions">
        <p class="auth-link-text">
          Remember your password?
          <a routerLink="/auth/login" class="auth-link">Sign in here</a>
        </p>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
